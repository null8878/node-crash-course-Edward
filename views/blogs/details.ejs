<%- include('../partials/header') %>

<article class="detail-card">
  <h1><%= blog.title %></h1>
  <p class="muted">ID: <%= blog.id %></p>
  <p><%= blog.body %></p>

  <div class="detail-actions">
    <a class="button ghost" href="/blogs">Back to list</a>
    <button id="delete-btn" class="button danger" data-id="<%= blog.id %>">Delete blog</button>
  </div>
</article>

<script>
  const deleteBtn = document.getElementById('delete-btn');

  deleteBtn?.addEventListener('click', async () => {
    const id = deleteBtn.dataset.id;
    const sure = confirm('Delete this blog?');

    if (!sure) return;

    // ok so fetch lets me call the DELETE route from the browser
    const res = await fetch(`/blogs/${id}`, { method: 'DELETE' });
    const data = await res.json();

    if (data.redirect) {
      window.location.href = data.redirect;
    }
  });
</script>

<%- include('../partials/footer') %>
